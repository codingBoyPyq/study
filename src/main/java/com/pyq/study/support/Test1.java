package com.pyq.study.support;

import java.io.*;

/**
 * Created by pangyueqiang on 17/7/18.
 */
public class Test1 {
    public static String value = "('#{data_time}', #{tenantId}, #{parent_department_id}, #{department_id}, 1, '#{depart_name}', 52, 21, 2.48, -0.2353, '[{\\\"userId\\\":1140355,\\\"userName\\\":\\\"刘春辉\\\",\\\"count\\\":4},{\\\"userId\\\":1478405,\\\"userName\\\":\\\"许珂\\\",\\\"count\\\":3},{\\\"userId\\\":681325,\\\"userName\\\":\\\"苏学瑞\\\",\\\"count\\\":3},{\\\"userId\\\":1045009,\\\"userName\\\":\\\"田勇泽\\\",\\\"count\\\":3},{\\\"userId\\\":664649,\\\"userName\\\":\\\"张士阳\\\",\\\"count\\\":3},{\\\"userId\\\":583249,\\\"userName\\\":\\\"詹婕\\\",\\\"count\\\":3},{\\\"userId\\\":591160,\\\"userName\\\":\\\"秦威\\\",\\\"count\\\":3},{\\\"userId\\\":1202138,\\\"userName\\\":\\\"邵焱\\\",\\\"count\\\":3},{\\\"userId\\\":819099,\\\"userName\\\":\\\"杨峰\\\",\\\"count\\\":3},{\\\"userId\\\":689578,\\\"userName\\\":\\\"邱婷婷\\\",\\\"count\\\":3},{\\\"userId\\\":1314268,\\\"userName\\\":\\\"葛社锋\\\",\\\"count\\\":3},{\\\"userId\\\":1321101,\\\"userName\\\":\\\"陶德森\\\",\\\"count\\\":3},{\\\"userId\\\":596312,\\\"userName\\\":\\\"王旭东\\\",\\\"count\\\":3},{\\\"userId\\\":689839,\\\"userName\\\":\\\"张航\\\",\\\"count\\\":2},{\\\"userId\\\":8716,\\\"userName\\\":\\\"张晓峰\\\",\\\"count\\\":2},{\\\"userId\\\":66316,\\\"userName\\\":\\\"宋攀\\\",\\\"count\\\":2},{\\\"userId\\\":533737,\\\"userName\\\":\\\"尹平玉\\\",\\\"count\\\":2},{\\\"userId\\\":1272033,\\\"userName\\\":\\\"刘雳炜\\\",\\\"count\\\":1},{\\\"userId\\\":875455,\\\"userName\\\":\\\"王明兴\\\",\\\"count\\\":1},{\\\"userId\\\":1272023,\\\"userName\\\":\\\"丘志伟\\\",\\\"count\\\":1}]', 5, 3, -0.1667, '[{\\\"userId\\\":1498654,\\\"userName\\\":\\\"何殷\\\",\\\"count\\\":3},{\\\"userId\\\":1140355,\\\"userName\\\":\\\"刘春辉\\\",\\\"count\\\":1},{\\\"userId\\\":15807,\\\"userName\\\":\\\"王渊西\\\",\\\"count\\\":1}]', 4, 3, -0.8, '[{\\\"userId\\\":1140355,\\\"userName\\\":\\\"刘春辉\\\",\\\"count\\\":2},{\\\"userId\\\":1498654,\\\"userName\\\":\\\"何殷\\\",\\\"count\\\":1},{\\\"userId\\\":15807,\\\"userName\\\":\\\"王渊西\\\",\\\"count\\\":1}]', 24, 22, 5, -0.1429, '[{\\\"userId\\\":1140355,\\\"userName\\\":\\\"刘春辉\\\",\\\"count\\\":10},{\\\"userId\\\":1272023,\\\"userName\\\":\\\"丘志伟\\\",\\\"count\\\":7},{\\\"userId\\\":1202138,\\\"userName\\\":\\\"邵焱\\\",\\\"count\\\":4},{\\\"userId\\\":66316,\\\"userName\\\":\\\"宋攀\\\",\\\"count\\\":2},{\\\"userId\\\":15807,\\\"userName\\\":\\\"王渊西\\\",\\\"count\\\":1}]', 10, 0, 0, 0, ' ', 0, 0, 0, -1, ' ', 624, 0.1111, 0, 0, '[{\\\"userId\\\":1295482,\\\"userName\\\":\\\"吴东鹏\\\",\\\"hoursPerDay\\\":12.63},{\\\"userId\\\":1498318,\\\"userName\\\":\\\"尚保林\\\",\\\"hoursPerDay\\\":12.53},{\\\"userId\\\":977539,\\\"userName\\\":\\\"游丰\\\",\\\"hoursPerDay\\\":12.47},{\\\"userId\\\":739379,\\\"userName\\\":\\\"王善\\\",\\\"hoursPerDay\\\":12.23},{\\\"userId\\\":1140353,\\\"userName\\\":\\\"徐晓松\\\",\\\"hoursPerDay\\\":12.2},{\\\"userId\\\":1492828,\\\"userName\\\":\\\"肖翔\\\",\\\"hoursPerDay\\\":12.17},{\\\"userId\\\":1283123,\\\"userName\\\":\\\"张军-算法\\\",\\\"hoursPerDay\\\":12.03},{\\\"userId\\\":852351,\\\"userName\\\":\\\"任倍成\\\",\\\"hoursPerDay\\\":11.83},{\\\"userId\\\":923710,\\\"userName\\\":\\\"张敏\\\",\\\"hoursPerDay\\\":11.63},{\\\"userId\\\":1115003,\\\"userName\\\":\\\"黄泓\\\",\\\"hoursPerDay\\\":11.6},{\\\"userId\\\":1457161,\\\"userName\\\":\\\"武海瑛\\\",\\\"hoursPerDay\\\":11.6},{\\\"userId\\\":875455,\\\"userName\\\":\\\"王明兴\\\",\\\"hoursPerDay\\\":11.47},{\\\"userId\\\":875453,\\\"userName\\\":\\\"蔡湜权\\\",\\\"hoursPerDay\\\":11.37},{\\\"userId\\\":1149683,\\\"userName\\\":\\\"谢于中\\\",\\\"hoursPerDay\\\":11.13},{\\\"userId\\\":1052543,\\\"userName\\\":\\\"邹彦\\\",\\\"hoursPerDay\\\":10.77},{\\\"userId\\\":1045059,\\\"userName\\\":\\\"周家木\\\",\\\"hoursPerDay\\\":10.57},{\\\"userId\\\":1397875,\\\"userName\\\":\\\"孟鹏远\\\",\\\"hoursPerDay\\\":10.5},{\\\"userId\\\":1492830,\\\"userName\\\":\\\"柏杨\\\",\\\"hoursPerDay\\\":10.4},{\\\"userId\\\":965400,\\\"userName\\\":\\\"陈波\\\",\\\"hoursPerDay\\\":10.23},{\\\"userId\\\":782454,\\\"userName\\\":\\\"陆西\\\",\\\"hoursPerDay\\\":9.9}]', '[{\\\"name\\\":\\\"07月03日\\\",\\\"y\\\":0.3163,\\\"abenseUserCount\\\":67,\\\"vacateUserCount\\\":21},{\\\"name\\\":\\\"07月04日\\\",\\\"y\\\":0.3367,\\\"abenseUserCount\\\":65,\\\"vacateUserCount\\\":11},{\\\"name\\\":\\\"07月05日\\\",\\\"y\\\":0.3333,\\\"abenseUserCount\\\":68,\\\"vacateUserCount\\\":9},{\\\"name\\\":\\\"07月06日\\\",\\\"y\\\":0.3824,\\\"abenseUserCount\\\":63,\\\"vacateUserCount\\\":10},{\\\"name\\\":\\\"07月07日\\\",\\\"y\\\":0.3725,\\\"abenseUserCount\\\":64,\\\"vacateUserCount\\\":12},{\\\"name\\\":\\\"07月08日\\\",\\\"y\\\":0.7674,\\\"abenseUserCount\\\":10,\\\"vacateUserCount\\\":12},{\\\"name\\\":\\\"07月10日\\\",\\\"y\\\":0.3462,\\\"abenseUserCount\\\":68},{\\\"name\\\":\\\"07月11日\\\",\\\"y\\\":0.3942,\\\"abenseUserCount\\\":63},{\\\"name\\\":\\\"07月12日\\\",\\\"y\\\":0.4038,\\\"abenseUserCount\\\":62}]', 0.38, 0.2453, 3.72, 0.2157, 173439.5, '[{\\\"name\\\":\\\"外部服务\\\",\\\"y\\\":108000},{\\\"name\\\":\\\"市场活动\\\",\\\"y\\\":21599},{\\\"name\\\":\\\"转账申请\\\",\\\"y\\\":20000},{\\\"name\\\":\\\"差旅费\\\",\\\"y\\\":19902.5},{\\\"name\\\":\\\"行政人事\\\",\\\"y\\\":3288},{\\\"name\\\":\\\"常用报销\\\",\\\"y\\\":650}]', '#{stage_id}', 2, 0.2341, 0, 0, 6, '[{\\\"name\\\":\\\"07月03日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月04日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月05日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月06日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月07日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月08日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月09日\\\",\\\"y\\\":0}]', 2, -0.5, '[{\\\"userId\\\":66316,\\\"userName\\\":\\\"宋攀\\\",\\\"count\\\":2}]', '[{\\\"name\\\":\\\"07月03日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月04日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月05日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月06日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月07日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月08日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月09日\\\",\\\"y\\\":0}]', 1.67, '[{\\\"name\\\":\\\"07月03日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月04日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月05日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月06日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月07日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月08日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月09日\\\",\\\"y\\\":0}]', 1.33, '[{\\\"name\\\":\\\"07月03日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月04日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月05日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月06日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月07日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月08日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月09日\\\",\\\"y\\\":0}]', '[]', 0, -1, '[{\\\"name\\\":\\\"07月03日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月04日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月05日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月06日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月07日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月08日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月09日\\\",\\\"y\\\":0}]', 4.8, '[{\\\"name\\\":\\\"07月03日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月04日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月05日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月06日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月07日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月08日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月09日\\\",\\\"y\\\":0}]', 4.4, 0.375, '[{\\\"userId\\\":1140355,\\\"userName\\\":\\\"刘春辉\\\",\\\"count\\\":8},{\\\"userId\\\":1272023,\\\"userName\\\":\\\"丘志伟\\\",\\\"count\\\":7},{\\\"userId\\\":1202138,\\\"userName\\\":\\\"邵焱\\\",\\\"count\\\":4},{\\\"userId\\\":66316,\\\"userName\\\":\\\"宋攀\\\",\\\"count\\\":2},{\\\"userId\\\":15807,\\\"userName\\\":\\\"王渊西\\\",\\\"count\\\":1}]', 0, 15, 77, 0, 69, '[{\\\"name\\\":\\\"07月03日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月04日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月05日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月06日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月07日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月08日\\\",\\\"y\\\":0},{\\\"name\\\":\\\"07月09日\\\",\\\"y\\\":0}]', 0, '[]')";
    public static String fields = "INSERT INTO `t_week_company_data` (`data_time`, `tenant_id`, `parent_department_id`, `department_id`, `department_type`, `department_name`, `outdoor_count`, `outdoor_creater_count`, `outdoor_average_count`, `outdoor_chain`, `outdoor_desc`, `customer_count`, `customer_creater_count`, `customer_chain`, `customer_desc`, `contact_count`, `contact_creater_count`, `contact_chain`, `contact_desc`, `record_count`, `record_customer_count`, `record_creater_count`, `record_chain`, `record_desc`, `contract_count`, `contract_creater_count`, `contract_total_amount`, `contract_chain`, `contract_desc`, `payback_count`, `payback_creater_count`, `payback_total_amount`, `payback_chain`, `payback_desc`, `all_need_punch`, `task_delay_percent`, `plan_payback_total_amount`, `opportunity_count`, `hard_work_desc`, `recent_department_participation`, `department_average_participation`, `department_average_participation_chain`, `department_average_worktime`, `department_average_worktime_chain`, `department_total_expense`, `department_expense_type`, `stage_id`, `outdoor_customer_count`, `contract_count_chain`, `predict_contract_count`, `predict_contract_ammount`, `change_user_count`, `outdoor_customer_days`, `outdoor_customer_count_average`, `outdoor_customer_chain`, `outdoor_customer_desc`, `customer_days`, `customer_count_average`, `contact_days`, `contact_count_average`, `opportunity_days`, `opportunity_desc`, `opportunity_count_average`, `opportunity_chain`, `record_days`, `record_count_average`, `record_customer_days`, `record_customer_average`, `record_customer_chain`, `record_customer_desc`, `early_punch_user_count`, `late_punch_user_count`, `no_punch_user_count`, `vacate_user_count`, `absence_user_count`, `outdoor_days`, `health_score`, `staff_risk_desc`)";
    public static final String sourcePath = "/Users/pangyueqiang/Desktop/source.data";
    public static final String targetPath = "/Users/pangyueqiang/Desktop/generator_weekData.sql";

    public static void main(String[] args) throws Exception{
        printIntoFile();
    }

    public static  String generatorSql() throws Exception {
        StringBuilder sb = new StringBuilder(fields + "\n VALUES \n ");
        BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(sourcePath)));
        String str = null;
        while((str = br.readLine())!=null)
        {
            String[] arr = str.split("\\t");
            sb.append( value.replace("#{data_time}",arr[0])
                    .replace("#{tenantId}",arr[1])
                    .replace("#{parent_department_id}",arr[2])
                    .replace("#{department_id}",arr[3])
                    .replace("#{depart_name}",arr[4])
                    .replace("#{stage_id}",arr[5]));
            sb.append(",\n");
        }
        return sb.deleteCharAt(sb.lastIndexOf(",")).append(";").toString();
    }
    public static void printIntoFile() throws Exception {
        BufferedWriter bufferedWriter = new BufferedWriter(new OutputStreamWriter( new FileOutputStream(new File(targetPath))));
        bufferedWriter.write(generatorSql());
        bufferedWriter.flush();
    }
}
